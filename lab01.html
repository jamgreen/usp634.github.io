<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Jamaal Green and Liming Wang" />


<title>Lab 1: Intro to R &amp; RStudio</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-1.1/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-1.1/highlight.js"></script>

<meta name="description" content="USP 634 Data Analysis I at Portland State Univeristy" />

<script type="text/javascript" src="js/rmarkdown.js"></script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-38176783-3', 'auto');
  ga('send', 'pageview');

</script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="css/rmarkdown.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">USP 634: Data Analysis I</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Lab 1: Intro to R &amp; RStudio</h1>
<h4 class="author"><em>Jamaal Green and Liming Wang</em></h4>
<h4 class="date"><em>4/4/2017</em></h4>

</div>


<p>Data file:</p>
<ul>
<li><a href="californiatod.csv" class="uri">californiatod.csv</a></li>
<li><a href="lab01.Rmd">R markdown</a></li>
</ul>
<div id="introduction-to-r" class="section level2">
<h2>Introduction to R</h2>
<ul>
<li>Download and Install</li>
<li>Getting Started: Understand Basic Data Structure and Conventions</li>
<li>Getting to Know Your Dataset: Variable Types</li>
<li>Construct Some Descriptive Statistics</li>
</ul>
</div>
<div id="download-and-install-r-for-those-not-on-lab-machines" class="section level2">
<h2>Download and Install R (for those not on lab machines)</h2>
<p>Install the R Software Go to <a href="http://cran.rstudio.com/" class="uri">http://cran.rstudio.com/</a> and click on Download R for Windows (or OSX), click on install R for the first time and download R. When the file is done downloading, double click “R-3.3.3-win.exe” (or apporiate installation file for your OS) to install the file and select Run, and continue with the installation wizard.</p>
<p>Install Rstudio There are many ways to interface with R from the bare-bones base R software, RStudio, or R Commander (a GUI wrapper for base R). We will be using RStudio for our labs. In order to install RStudio visit <a href="http://www.rstudio.com/products/rstudio/download" class="uri">http://www.rstudio.com/products/rstudio/download</a> and download RStudio for desktop for your operating system. If in the lab and RStudio is not installed and the software manager is not working you can download the zip/tar RStudio for windows, open the zip file, and run RStudio without installing. If you must do this, then I recommend downloading the zip/tar file to your H: drive where it can rest.</p>
</div>
<div id="getting-started-understand-basic-data-structure-and-conventions" class="section level2">
<h2>Getting Started: Understand basic data structure and conventions</h2>
<p>Downlad the <a href="lab/californiatod.csv">californiatod.csv</a> file and save in your personal folder or C: drive. Open up RStudio, click Tools –&gt; Import Dataset –&gt; From Local File and navigate to your folder and click the csv. Make sure the Heading option is marked as “Yes” and press Ok.</p>
<pre class="r"><code>#install.packages(readr)
library(readr)
catod &lt;- read_csv(&quot;californiatod.csv&quot;)</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   name = col_character(),
##   region = col_character(),
##   transit = col_double(),
##   density = col_double(),
##   houseval = col_double(),
##   railtype = col_character()
## )</code></pre>
<p>Environment Tab You can see your data by clicking on the Environment Tab in the upper right corner of your RStudio console and clicking the table catod.</p>
<p>Create Quick Summary In your console type</p>
<pre class="r"><code>summary(catod)</code></pre>
<pre><code>##      name              region             transit          density      
##  Length:26          Length:26          Min.   :0.0000   Min.   : 1.720  
##  Class :character   Class :character   1st Qu.:0.1162   1st Qu.: 3.225  
##  Mode  :character   Mode  :character   Median :0.1883   Median : 4.335  
##                                        Mean   :0.2529   Mean   : 5.360  
##                                        3rd Qu.:0.3833   3rd Qu.: 5.135  
##                                        Max.   :0.6429   Max.   :14.850  
##     houseval        railtype        
##  Min.   : 89046   Length:26         
##  1st Qu.:195318   Class :character  
##  Median :258209   Mode  :character  
##  Mean   :282155                     
##  3rd Qu.:314860                     
##  Max.   :779792</code></pre>
<div id="getting-to-know-your-dataset-variable-types" class="section level3">
<h3>Getting to Know Your Dataset: Variable Types</h3>
<p>Look at the output from the dataset summary. We can see that “name”, “region”, and “railtype” are nominal variables (frequency count only), and “transit”, “density”, and “houseval” are interval-ration data (summary statistics).</p>
<p>Create a frequency table (nominal variables). We will create a frequency table using the table() function in R for “railtype”. This can be used to get basic frequencies for one or two variables (one for columns and one for rows). Note that the $ operator after the name of the table tells R which column(s) in our dataframe to reference.</p>
<pre class="r"><code>table(catod$railtype)</code></pre>
<pre><code>## 
## Heavy or commuter rail             Light rail 
##                     17                      9</code></pre>
</div>
<div id="construct-descriptive-statistics" class="section level3">
<h3>Construct Descriptive Statistics</h3>
<p>The methods for analyzing your variables depend on the variable type.</p>
<div id="categorialnominal-variables" class="section level4">
<h4>Categorial/Nominal Variables</h4>
<ul>
<li><p>Create a Frequency Table. Frequency tables help us to understand categorical variables. To create one use the table() function.</p></li>
<li><p>Create a Cross-Tabulation Table. To see how rail type breaks down by region we will create a cross-tabulation table for the two categorical variables (railtype and region). Which region has the most light rail TOD sites in this dataset?</p></li>
</ul>
<pre class="r"><code>table(catod$railtype, catod$region)</code></pre>
<pre><code>##                         
##                          Bay Area LA Sacramento SD
##   Heavy or commuter rail       12  4          0  1
##   Light rail                    1  2          2  4</code></pre>
</div>
<div id="continuous-ordinal-or-interval-ratio-variables" class="section level4">
<h4>Continuous (ordinal or Interval-Ratio) variables</h4>
<p>In order to produce summary statistics for continuous variables we will use the summary() function. And to calculate the standard deviation we will use the sd() function.</p>
<pre class="r"><code>summary(catod$density)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   1.720   3.225   4.335   5.360   5.135  14.850</code></pre>
<pre class="r"><code>sd(catod$density)</code></pre>
<pre><code>## [1] 3.531352</code></pre>
<p>An alternative way that will give us summary statistics for all of the continuous variables in our dataframe in a neat table is to use the stargazer pacakge.</p>
<p>Compare the mean density to the minimum and maximum value for transit usage. Is the mean closer to the minimum or the maximum? How does it compre to the median? What does this tell us?</p>
<pre class="r"><code>#first we will install and unpack stargazer
#install.packages(&quot;stargazer&quot;)
library(stargazer)</code></pre>
<pre><code>## 
## Please cite as:</code></pre>
<pre><code>##  Hlavac, Marek (2015). stargazer: Well-Formatted Regression and Summary Statistics Tables.</code></pre>
<pre><code>##  R package version 5.2. http://CRAN.R-project.org/package=stargazer</code></pre>
<pre class="r"><code>stargazer(catod, type = &quot;text&quot;)</code></pre>
<pre><code>## 
## =================================
## Statistic N Mean St. Dev. Min Max
## =================================</code></pre>
<p>Let’s explore further. This time we will include the skewness and kurtosis of our summary stats. (we will use the psych package for this)</p>
<pre class="r"><code>#the psych package gives us some more powerful summary #functions that give us even more summary values than just
#mean and median

#install.packages(&quot;psych&quot;)  
#just delete the # before the install.packages() to install psych

library(psych)

describe(catod)</code></pre>
<pre><code>##           vars  n      mean        sd    median   trimmed      mad
## name*        1 26       NaN        NA        NA       NaN       NA
## region*      2 26       NaN        NA        NA       NaN       NA
## transit      3 26      0.25      0.19      0.19      0.24     0.19
## density      4 26      5.36      3.53      4.34      4.81     1.62
## houseval     5 26 282154.69 163092.19 258209.17 258284.88 96930.33
## railtype*    6 26       NaN        NA        NA       NaN       NA
##                min       max     range skew kurtosis       se
## name*          Inf      -Inf      -Inf   NA       NA       NA
## region*        Inf      -Inf      -Inf   NA       NA       NA
## transit       0.00      0.64      0.64 0.54    -0.96     0.04
## density       1.72     14.85     13.13 1.53     1.38     0.69
## houseval  89045.74 779791.98 690746.24 1.57     2.08 31985.01
## railtype*      Inf      -Inf      -Inf   NA       NA       NA</code></pre>
</div>
<div id="histograms" class="section level4">
<h4>Histograms</h4>
<p>As with all things in R there are multiple ways to get to the same spot. We will make a histogram in order to look at the distribution of transit usage frequency using base R commands and then using the ggplot2 package.</p>
<pre class="r"><code>hist(catod$transit, main=&quot;Histogram of Transit Usage&quot;, xlab = &quot;Transit Usage&quot;)</code></pre>
<p><img src="lab01_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre class="r"><code>#install.packages(&quot;ggplot2&quot;)
library(ggplot2)</code></pre>
<pre><code>## 
## Attaching package: &#39;ggplot2&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:psych&#39;:
## 
##     %+%, alpha</code></pre>
<pre class="r"><code>p1 &lt;- ggplot(catod, aes(x = transit))
p1 + geom_histogram()</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="lab01_files/figure-html/unnamed-chunk-9-2.png" width="672" /></p>
<p>Look at the histogram for density. What does this indicate about whether more TOD sites are located in high or low-density areas?</p>
</div>
<div id="scatterplot" class="section level4">
<h4>Scatterplot</h4>
<p>A scatterplot will show us the relationship between two continuous variables. Again we will use a base R and ggplot approach.</p>
<pre class="r"><code>#comparing transit usage and houseval

plot(catod$transit, catod$houseval)</code></pre>
<p><img src="lab01_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<pre class="r"><code>#we will install the &quot;scales&quot; package so we can label
# our Y axis in dollars
#install.packages(&quot;scales&quot;)
library(scales)</code></pre>
<pre><code>## 
## Attaching package: &#39;scales&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:psych&#39;:
## 
##     alpha, rescale</code></pre>
<pre><code>## The following objects are masked from &#39;package:readr&#39;:
## 
##     col_factor, col_numeric</code></pre>
<pre class="r"><code>p2 &lt;- ggplot(catod, aes(x=transit, y = houseval))
p2 + geom_point() + scale_y_continuous(labels = scales::dollar)</code></pre>
<p><img src="lab01_files/figure-html/unnamed-chunk-10-2.png" width="672" /></p>
</div>
<div id="tables-of-statistics" class="section level4">
<h4>Tables of Statistics</h4>
<p>Create a two-way cross Run a two-way cross-tabulation for each of the following questions:</p>
<ul>
<li>Does transit usage vary by region?</li>
<li>Does transit usage vary by rail type?</li>
</ul>
<p>Then we will measure the two-way cross tab of these two categorical variables with the means of a continuous third variable. This sounds complex but we shall approach it in a straight forward way using the dplyr package.</p>
<pre class="r"><code>#in order to get these cross tabs with the additional #continuous variable we will use the table() function then
#dplyr

#install.packages(&quot;dplyr&quot;)
library(dplyr)</code></pre>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<pre class="r"><code>table(catod$region, catod$railtype)</code></pre>
<pre><code>##             
##              Heavy or commuter rail Light rail
##   Bay Area                       12          1
##   LA                              4          2
##   Sacramento                      0          2
##   SD                              1          4</code></pre>
<pre class="r"><code>catod %&gt;% group_by(region, railtype) %&gt;%
  summarise(avg_transit = mean(transit))</code></pre>
<pre><code>## Source: local data frame [7 x 3]
## Groups: region [?]
## 
##       region               railtype avg_transit
##        &lt;chr&gt;                  &lt;chr&gt;       &lt;dbl&gt;
## 1   Bay Area Heavy or commuter rail   0.3732583
## 2   Bay Area             Light rail   0.0000000
## 3         LA Heavy or commuter rail   0.2090250
## 4         LA             Light rail   0.1589000
## 5 Sacramento             Light rail   0.1900500
## 6         SD Heavy or commuter rail   0.1538000
## 7         SD             Light rail   0.1020000</code></pre>
<p>The dplyr package is designed to perform table operations on dataframes for data manipulation and some summarization. The preceding syntax told R to take our catod dataframe, group by the variables for region and railtype, and then calculate the mean transit usage from there. This is similar to the kind of pivot table operations one can do in excel.</p>
</div>
</div>
</div>
<div id="other-useful-tidbits" class="section level2">
<h2>Other Useful Tidbits</h2>
<ul>
<li><p>Script Window</p>
<p>If you click button with the little green + sign in the upper left corner of your screen you will get a series of options. Click “R Script” and this will open a new window of an R script file. R script files are simply text files that hold our R code. You can type commands into them and press Run at the top of the window to run the entire script. If you scroll to the end of the line you just typed and hit “CTRL+r” R-Studio will execute that line. Additionally you can highlight multiple lines of code and type “CTRL+Enter” and it will return the selection.</p></li>
<li><p>Area under the curve (withou z-score lookup)</p>
<p>If you’re trying to find out what proportion of the sample had incomes between $25,000-$30,000 (assuming a normal distribution of income), and you know the mean income is $20,000 and the standard deviation is $10,000, you can look up the proportion using the pnorm function.</p>
<p>Type the command into the script window and hit “Run”</p></li>
</ul>
<pre class="r"><code>pnorm(30000, mean = 20000, sd= 10000) </code></pre>
<pre><code>## [1] 0.8413447</code></pre>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>


</body>
</html>
